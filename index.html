<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>3D 同步時鐘</title>
<style>
body { margin:0; overflow:hidden; background:#111; }
#info {
    position:absolute;
    top:10px;
    width:100%;
    text-align:center;
    color:white;
    font-family:sans-serif;
}
</style>
</head>
<body>
<div id="info">同步系統時間中…</div>

<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
    "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
  }
}
</script>

<script type="module">
import * as THREE from 'three';
import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 100);
camera.position.set(0, 2.5, 6);
camera.rotation.x = THREE.MathUtils.degToRad(-25); // 固定視角

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

// 光
scene.add(new THREE.AmbientLight(0xffffff, 0.9));
const d = new THREE.DirectionalLight(0xffffff, 1);
d.position.set(5,10,5);
scene.add(d);

let hourHand, minuteHand, secondHand;

const loader = new GLTFLoader();
loader.load('./2026-01-05.glb', gltf => {
    const model = gltf.scene;
    scene.add(model);

    model.traverse(o => console.log('node:', o.name));

    hourHand   = model.getObjectByName('HourHand');
    minuteHand = model.getObjectByName('MinuteHand');
    secondHand = model.getObjectByName('SecondHand');

    if (!hourHand || !minuteHand || !secondHand) {
        document.getElementById('info').innerText = '❌ 指針名稱抓不到（看 console）';
        return;
    }

    document.getElementById('info').innerText = '✔ 時鐘同步中';
});

function animate(){
    requestAnimationFrame(animate);

    if (hourHand) {
        const now = new Date();
        const s = now.getSeconds() + now.getMilliseconds()/1000;
        const m = now.getMinutes() + s/60;
        const h = (now.getHours()%12) + m/60;

        // 改成 Z 軸（最安全）
        secondHand.rotation.z = -s/60 * Math.PI*2;
        minuteHand.rotation.z = -m/60 * Math.PI*2;
        hourHand.rotation.z   = -h/12 * Math.PI*2;
    }

    renderer.render(scene, camera);
}
animate();

addEventListener('resize', ()=>{
    camera.aspect = innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
});
</script>
</body>
</html>


